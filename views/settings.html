{{template "layout.html" .}}

{{define "content"}}
<div class="w-full p-4 flex flex-col items-center" id="content">
    <div role="button" class="bg-white bg-opacity-10 rounded-2xl px-10 py-2 text-white font-bold w-fit h-fit"
        hx-get="/settings/backgrounds" hx-swap="afterend">
        Change Background
    </div>
</div>
{{ end }}

{{ define "bg-popup" }}
<div class="absolute bg-black bg-opacity-20 backdrop-blur h-full w-full top-0 left-0 rounded-[32px] px-16 py-10 flex flex-col"
    id="bg-popup">
    <div class="absolute top-8 right-8 hover:bg-white hover:bg-opacity-10 duration-200 p-2 rounded-xl"
        hx-get="data:text/html," hx-target="#bg-popup" hx-swap="delete">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="white"
            class="w-6 h-6">
            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" />
        </svg>
    </div>

    <h2 class="text-3xl font-bold text-white mb-4">Background modification</h2>

    <label htmlFor="bg_filepicker" class="flex items-center space-x-1 text-white bg-white bg-opacity-10 px-8 py-2 rounded-2xl border border-white border-opacity-15 
    w-fit mb-8 hover:bg-opacity-15 duration-200">
        <input class="hidden" type="file" name="file" id="bg_filepicker" aria-describedby="selected-file" hx-on="change"
            hx-post="/settings/backgrounds" hx-encoding="multipart/form-data" accept="image/*" hx-target="#bg-item-list"
            hx-swap="beforeend" />
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="white"
            class="w-5 h-5">
            <path stroke-linecap="round" stroke-linejoin="round"
                d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5" />
        </svg>
        <span>Upload New</span>
    </label>

    <div class="flex flex-wrap max-h-full overflow-x-scroll" id="bg-item-list">
        {{range .Backgrounds}}
        {{ block "bg-item" . }}{{end}}
        {{end}}
    </div>
</div>
{{ end }}

{{ define "bg-item" }}
<div id="item-{{.Id}}" class="mr-8">
    <p class="text-white font-bold mb-1">{{.Filename}}</p>
    <img src="/images/background/{{.Filename}}" alt="bg-{{.Filename}}" class="h-44 rounded-lg mb-2">
    <div class="flex space-x-2">
        <div id="button-bg-{{.Id}}">
            {{if .Selected }}
            {{ block "button-bg-selected" . }}{{end}}
            {{ else }}
            {{ block "button-bg-select" . }}{{end}}
            {{ end }}
        </div>
        <div role="button" class="flex items-center text-c-red bg-c-red bg-opacity-10 py-2 px-3 rounded-2xl border border-c-red border-opacity-15 
        w-fit mb-8 hover:bg-opacity-15 duration-200" hx-delete="/settings/backgrounds/{{.Id}}"
            hx-target="#item-{{.Id}}" hx-swap="delete">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                stroke="currentColor" class="w-5 h-5">
                <path stroke-linecap="round" stroke-linejoin="round"
                    d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0" />
            </svg>
        </div>
    </div>
</div>
{{ end }}

{{ define "button-bg-selected" }}
<div role="button" class="flex items-center space-x-1 text-c-cyan bg-c-cyan bg-opacity-10 px-8 py-2 rounded-2xl border border-c-cyan border-opacity-15 
w-fit mb-8 hover:bg-opacity-15 duration-200">
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
        class="w-5 h-5">
        <path stroke-linecap="round" stroke-linejoin="round" d="m4.5 12.75 6 6 9-13.5" />
    </svg>
    <span>Set</span>
</div>
{{ end }}

{{ define "button-bg-select" }}
<div role="button" class="flex items-center space-x-1 text-white bg-white bg-opacity-10 px-8 py-2 rounded-2xl border border-white border-opacity-15 
w-fit mb-8 hover:bg-opacity-15 duration-200" hx-post="/settings/backgrounds/selected/{{.Id}}" hx-target="#background">
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
        class="w-6 h-6">
        <path stroke-linecap="round" stroke-linejoin="round"
            d="M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 0 0-3.7-3.7 48.678 48.678 0 0 0-7.324 0 4.006 4.006 0 0 0-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 0 0 3.7 3.7 48.656 48.656 0 0 0 7.324 0 4.006 4.006 0 0 0 3.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3-3 3" />
    </svg>
    <span>Set</span>
</div>
{{ end }}

{{ define "oob-button-bg-select" }}
<div id="button-bg-{{.Id}}" hx-swap-oob="outerHTML">
    {{ block "button-bg-select" . }}{{end}}
</div>
{{ end }}

{{ define "oob-button-bg-selected" }}
<div id="button-bg-{{.Id}}" hx-swap-oob="outerHTML">
    {{ block "button-bg-selected" . }}{{end}}
</div>
{{ end }}